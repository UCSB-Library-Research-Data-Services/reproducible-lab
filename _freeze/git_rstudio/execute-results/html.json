{
  "hash": "1651095d4504b90f4b441783292aba69",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Using git and GitHub with RStudio\"\n---\n\nThis session will cover:\n\n- Setting up `git` on computer\n  - Installing git\n  - Setting up your identity\n- git basic workflow using RStudio\n  - Cloning a Repository from GitHub to your computer using RStudio projects\n  - Tracking changes to your scripts\n  - Pushing your changes to GitHub\n\n\n# Setting up git on your computer\n\n`MacOSX` and `Linux` computers all come with git pre-installed, but it is not always directly usable. The best way to test if `git` is ready to use is at the command line:\n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit --version\n# git version 2.39.3\n```\n:::\n\n\nIt should return something like above. **If you get an error, you will have to install git**\n\n\n## Installing git\n\nYou can download a copy of `git` here: https://git-scm.com/downloads and follow the instructions according to your Operating System. \n\n\n### Windows\n\nYou can keep the options to default during the installation, until you reach `Configuring the terminal emulator to use with Git Bash` -> be sure `Use MinTTY` is selected.  This will install both git and a set of useful command-line tools using a trimmed down Bash shell. \n\n\n### Mac OSX \n\nDepending on the version, you might have to run a few commands from the terminal. Please refer to the `README.txt` that comes with the download regarding the exact steps to follow.\n\n\n## Setting up your `git` identity\n\nBefore you start using git on any computer, you will have to set your identity on your system, as every snapshot of files is associated with the user who implemented the modifications to the file(s).\n\nOpen the `Terminal` or `git bash` and then type the following commands.\n\n### Setup your profile\n\n#### At the commande line\n\nIf you are not sure if you have already set your git identity you can check this running this command:\n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit config --global --list\n```\n:::\n\n\nIf you identity is not set yet, you need to provide your name and email (we recommend to use the same email as used when setting your GitHub account): \n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit config --global user.name \"your Full Name\"\ngit config --global user.email \"your Email\"\n```\n:::\n\n\n\n##### Optional\n\nCheck that everything is correct: \n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit config --global --list\n```\n:::\n\n\nModify everything at the same time:\n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit config --global --edit\n```\n:::\n\n\nSet your text editor: \n\n\n::: {.cell}\n\n```{.bash .cell-code}\ngit config --system core.editor nano\n```\n:::\n\n\nHere [`nano`](https://www.nano-editor.org) is used as example; you can choose most of the text editor you might have installed on your computer (atom, sublime, notepad++ ...).\n\nProblem with any of those steps? Check out Jenny Brian [Happy git trouble shooting section](http://happygitwithr.com/troubleshooting.html){target=\"_blank\"}\n\n\n#### Using R\n\nIf you are an R user, the `usethis` package is your friend!! You can use this package to check and set up your git identity.\n\nCheck if you identity is set up:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"usethis\")\nusethis::git_sitrep()\n```\n:::\n\n\nIf you git identity is not yet set, you should see something like this:\n\n![](img/github_config_check.png)\n\nYou can set your git user name and email as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_git_config(user.name = \"Julien Brun\", user.email = \"julien.brun@ucsb.edu\")\n```\n:::\n\n\n\n## Linking git and RStudio\n\nIn most cases, RStudio should automatically detect `git` when it is installed on your computer. The best way to check this is to go to the `Tools` menu `-> Global Option`s and click on `git/SVN`\n\nIf `git` is properly set up, the window should look like this:\n\n<img style=\"align: left;width: 450px;\" src=img/rstudio-git.png />\n\nClick `OK`. \n\n_Note:_ if `git` was not enabled, you might be asked to restart RStudio to enable it.\n\n\n## Setting up your GitHub Personal Access Token (PAT)\n\nAlmost there! The last setup step we need to do is taking care of our authentication with GitHub, so we can download and upload changes to GitHub. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::create_github_token()\n```\n:::\n\n\nThis will open your web browser and send you to a page on GitHub (you might be asked to log in your account). Most of the options have already been set for us, we only need to update:\n\n- the _Note_ field by describing what is the token for. We recommend a combination describing the computer it is use on and what it is going to be use for.\n- _Expiration_ to 90 days. Note that GitHub will send you an email when it‚Äôs time to renew your token that is about to expire. It is easier to not let the token expire, otherwise you will have to regenerate a new one and do all the setup again.\n\n![](img/github_setup-01_pat.png)\nYou can leave all the other options as selected. Click on _Generate token_ green button at the bottom of the page. \n\nYou should be redirected to a new page where you can see your token. **This is the only time you will be able to see it, so do _not_ close this page before you are done with the setup!**. Copy your PAT to your clipboard. Back to RStudio, run the following command:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngitcreds::gitcreds_set()\n```\n:::\n\n\nThis will prompt you to paste the PAT you just copied from GitHub. Paste your PAT and hit Enter. You you should see a few message letting you know that the token has been setup.\n\nCongratulations, you are all done with setting up your computer üéâ It is a one time job, but note that if you use several computers/servers, you will have to do those steps again on each machine.\n\n---\n\n# Tracking File Changes with `git` \n\n## Basic Workflow Overview\n\n<img style=\"float: right;width: 300px;\" src=\"img/git_workflow_general.png\">\n\n1. You modify files in your working directory and save them as usual\n\n2. You **add** snapshots of your changed files to your staging area\n\n3. You do a **commit**, which takes the files as they are in the staging area and permanently stores them as snapshots to your Git directory.\n\n\nWe can make an analogy with taking a family picture, where each family member would represent a file.\n\n- **Add**ing files (to the staging area), is like deciding which family member(s) are going to be on your next picture\n- **Commit**ting is like taking the picture\n\nThis 2-step process enables you to flexibly group files into a specific commit.\n\nThese steps are repeated for every version you want to keep (every time you would like to use `save as`). Every time you commit, you create a new snapshot, and you add the new version of the file to the git database while keeping all the previous versions in the database. It creates a history of the content of your repository that is like a graph that you can navigate:\n\n<img style=\"align: left;width: 200px;\" src=img/version-graph_mattJones.png />\n\n## Using git from Rstudio\n\n### Tracking changes\n\nRStudio provides a great interface to git helping you navigate the git workflow and getting information about the state of your repository through nice icons and visualizations of the information.\n\nIf you click on the `Git` tab in your RStudio upper-right panel, you should see the following information\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-panel.png){fig-align='center' width=60%}\n:::\n:::\n\n\nThe RStudio Git pane lists every file that‚Äôs been added, modified or deleted. The icon describes the change:\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![from R packages, H. Wickham](img/rstudio-git-icons.png){fig-align='left' width=80%}\n:::\n:::\n\n\nIn our case, it means that:\n\n- the `.gitignore`file has been modified since the last commit\n- the  `.Rproj` file has never been tracked by `git`  (remember RStudio just created this project file for us)\n\nNote also that the `README.md` file is not listed, but it exists (see `Files`pane). It is because files with no modifications since the last commit are not listed. \n\nGitHub has created the `.gitignore` file for us and we have not modified it since. So why is it listed as modified? We can check this by clicking on the `Diff` button (upper-left on the Git pane).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-diff.png){fig-align='center' width=70%}\n:::\n:::\n\n\nWe can see that a new line (in green) has been added at the end of the `.gitignore` file. In fact, RStudio did that when creating the project to make sure that some temporary files were not tracked by git.\n\nLet us improve the content of the `README.md` file  as below to make it more descriptive.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-readme.png){fig-align='center' width=70%}\n:::\n:::\n\n\nAs soon as you save your changes, you should see the `README.md` file listed as modified in the git pane.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-panel-modified.png){fig-align='center' width=70%}\n:::\n:::\n\n\nLet us look at the diff of the `README.md` file. As you can see, the original lines are in red, in other words for git those lines have been deleted. The new lines that we just typed are in green, which indicates that these lines have been added for git. Note the line numbers in the left margin that help you to track which lines have been removed and added.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-diff-readme.png){fig-align='center' width=70%}\n:::\n:::\n\n\n### Keeping Changes as Snapshots\n\nNow we would like to save a snapshot of this version of the `README.md` file. Here are the steps we will need to do:\n\n1. Add the file to the next commit by checking the box in front of the file name in the git pane.  \nNote that the icon `M` will move to the left to show you that this file is now staged to be part of the next commit\n2. Commit:\n    a. Click the `Commit` button at the top of the git pane\n    b. Write a short but descriptive commit message in the new window\n    c. Click on the the `Commit` button to save this version of the file in the git database\n    d. Close the windows to get back to the main RStudio window\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-first-commit.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\nOnce done, add both the `.gitignore` and the `myfirst-repo.Rproj` and commit those files together.\n\n<img style=\"align: left;width: 35px;\" src=img/tip.png /> Note that the icons at the top of the git pane have been organized in sequence from left to right to match the git workflow.\n\n### Good Commit Message Tips\n\nClearly, good documentation of what you‚Äôve done is critical to making the version history of your repository meaningful and helpful. It is tempting to skip the commit message altogether, or to add some simple message like ‚ÄòUpdates‚Äô. It is better to use messages that will be helpful to your future self in deducing not just what you did, but why you did it. Also, commit messages are best understood if they follow the active verb convention. For example, you can see that my commit messages all started with a past tense verb, and then explained what was changed.\n\nWhile some of the changes we illustrated here were simple and easily explained in a short phrase, for more complex changes, it is best to provide a more complete message. The convention, however, is to always have a short, terse first sentence, followed by a more verbose explanation of the details and rationale for the change. This keeps the high level details readable in the version log. I can not count the number of times I have looked at the commit log from 2, 3, or 10 years prior and been so grateful for the diligence of my past self and collaborators.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![from xkcd comics](img/xkcd_commit_comic.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n## Looking at the Repository History\n\nWe have done 2 new commits at this point. Let us look at the commit timeline we have created so far. You can click on the `Clock` icon at the top to visualize the history.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/rstudio-git-history.png){fig-align='center' width=70%}\n:::\n:::\n\n\nYou can see that there has been 3 commits so far. The first one was done by GitHub when we created the repository and the 2 commits we just did. The most recent commit is at the top.\n\n\n## Sending changes back to GitHub\n\nNow that we have created these two commits on our local machine, our local version of the repository is different from the version on GitHub. RStudio communicate this information to you. If you look below the icons on the git pane, you will see the warning message: \"Your branch is ahead of 'origin/master' by two commits\". This can be translated as you have two additional commits on your local machine that you never shared back to the remote repository on GitHub. Open your favorite web browser and look at the content of your repository on GitHub. You will see the old version of the `README.md` and `.gitignore` file and no trace of the `.Rproj` file.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/git_repo-not-synched.png){fig-align='center' width=696}\n:::\n:::\n\n\nThere are two git commands to exchange between local and remote versions of a repository:\n\n- `pull`: git will get the latest remote version and try to merge it with your local version\n- `push`: git will send your local version to the remote version of the repository (in our case GitHub)\n\nBefore sending your local version to the remote, you should always get the latest remote version first. In other words, you should pull first and push second. This is the way git protects the remote version against incompatibilities with the local version. You always deal with potential problems on your local machine. Therefore your sequence will always be:\n\n1. `pull`\n2. `push`\n\nRStudio has icons for that on top of the git pane, with the blue arrow down being for `pull` and the green arrow up being for `push`. Remember the icons are organized in sequence!\n\nLet us do the pull and push to synchronize the remote repositories. We have now synchronized the local (our computer) and remote (on GitHub) versions of our repository.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/git_repo-synched.png){fig-align='center' width=664}\n:::\n:::\n\n\nYou can now look at the page of your repository on GitHub, you should see 3 files with the exact same version that you have on your local!\n\n\n::: {.callout-note}\n### Stage versus Commit\n\nThe functional difference between ‚Äústaging‚Äù a file and ‚Äúcommitting‚Äù one can be a little tough to grasp at first so let‚Äôs explore that briefly here. We can make an analogy with taking a family picture, where each family member would represent a file.\n\n- Staging files is like deciding which family member(s) are going to be in your next picture\n- Committing is like taking the picture\n\nThis 2-step process enables you to flexibly group files into a specific commit. Those groupings can be helpful to you later if you‚Äôre trying to find what you changed for a specific task (because those changes likely are all in the same commit).\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}